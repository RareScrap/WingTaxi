<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Быстрый старт. Размещение интерактивной карты на странице</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <script src="https://api-maps.yandex.ru/2.1/?lang=ru_RU" type="text/javascript">
    </script>
    <script type="text/javascript">
        ymaps.ready(init);

        function init(){
			var myPlacemark,
				myMap = new ymaps.Map("map", {
					center: [52.286387, 104.280660],
					zoom: 15
				});

            myPlacemark = new ymaps.Placemark([52.286387, 104.280660], {
                hintContent: 'Иркутск!',
                balloonContent: 'Заебись'
            });
            myMap.geoObjects.add(myPlacemark);


            // Обработка события, возникающего при щелчке
			// левой кнопкой мыши в любой точке карты.
			// При возникновении такого события откроем балун.
			myMap.events.add('click', function (e) {
				var coords = e.get('coords');

				// Если метка уже создана – просто передвигаем ее.
				if (myPlacemark) {
					myPlacemark.geometry.setCoordinates(coords);
				}
				// Если нет – создаем.
				else {
					myPlacemark = createPlacemark(coords);
					myMap.geoObjects.add(myPlacemark);
					// Слушаем событие окончания перетаскивания на метке.
					myPlacemark.events.add('dragend', function () {
						getAddress(myPlacemark.geometry.getCoordinates());
					});
				}
       
				myPlacemark.properties.set('iconCaption', 'поиск...');
				ymaps.geocode(coords).then(function (res) {
					var firstGeoObject = res.geoObjects.get(0);

					myPlacemark.properties
						.set({
							// Формируем строку с данными об объекте.
							iconCaption: [
								// Название населенного пункта или вышестоящее административно-территориальное образование.
								firstGeoObject.getLocalities().length ? firstGeoObject.getLocalities() : firstGeoObject.getAdministrativeAreas(),
								// Получаем путь до топонима, если метод вернул null, запрашиваем наименование здания.
								firstGeoObject.getThoroughfare() || firstGeoObject.getPremise()
							].filter(Boolean).join(', '),
							// В качестве контента балуна задаем строку с адресом объекта.
							balloonContent: firstGeoObject.getAddressLine()
						});
				});
			});

			// Обработка события, возникающего при щелчке
			// правой кнопки мыши в любой точке карты.
			// При возникновении такого события покажем всплывающую подсказку
			// в точке щелчка.
			myMap.events.add('contextmenu', function (e) {
				myMap.hint.open(e.get('coords'), 'Кто-то щелкнул правой кнопкой');
			});

			// Скрываем хинт при открытии балуна.
			myMap.events.add('balloonopen', function (e) {
				myMap.hint.close();
			});

			// Создание метки.
			function createPlacemark(coords) {
				return new ymaps.Placemark(coords, {
					iconCaption: 'поиск...'
				}, {
					preset: 'islands#violetDotIconWithCaption',
					draggable: true
				});
			}
		}
    </script>
</head>

<body>
    <div id="map" style="width: 600px; height: 400px"></div>
</body>

</html>